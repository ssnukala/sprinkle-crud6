{
  "description": "Model definitions for generating integration test paths",
  "version": "1.0",
  "security_notes": {
    "reserved_ids": {
      "user_id_1": "Reserved for system admin user - NEVER use in DELETE/DISABLE tests",
      "group_id_1": "Reserved for admin group - NEVER use in DELETE/DISABLE tests"
    },
    "test_data_range": "All test IDs start from 2 to avoid conflicts with system records",
    "safe_operations": "DELETE and DISABLE operations should only target IDs >= 2"
  },
  "models": {
    "users": {
      "name": "users",
      "singular": "user",
      "api_prefix": "/api/crud6",
      "frontend_prefix": "/crud6",
      "test_id": 2,
      "safe_test_id_note": "Uses ID 2+ to avoid admin user (ID 1)",
      "api_validation_keys": ["id", "user_name", "email"],
      "list_validation_keys": ["rows"],
      "enabled": true,
      "relationships": [
        {
          "name": "roles",
          "type": "many_to_many",
          "nested_endpoint": true
        },
        {
          "name": "activities",
          "type": "has_many",
          "nested_endpoint": true
        },
        {
          "name": "permissions",
          "type": "many_to_many_through",
          "through": "roles",
          "nested_endpoint": true
        }
      ],
      "custom_actions": [
        "reset_password",
        "enable_user",
        "disable_user"
      ],
      "field_toggles": [
        "flag_enabled",
        "flag_verified"
      ],
      "create_payload": {
        "user_name": "apitest",
        "first_name": "API",
        "last_name": "Test",
        "email": "apitest@example.com",
        "password": "TestPassword123"
      }
    },
    "groups": {
      "name": "groups",
      "singular": "group",
      "api_prefix": "/api/crud6",
      "frontend_prefix": "/crud6",
      "test_id": 2,
      "safe_test_id_note": "Uses ID 2+ to avoid admin group (ID 1)",
      "api_validation_keys": ["id", "slug", "name"],
      "list_validation_keys": ["rows"],
      "enabled": true,
      "relationships": [
        {
          "name": "users",
          "type": "has_many",
          "nested_endpoint": true
        }
      ],
      "create_payload": {
        "slug": "api_test_group",
        "name": "API Test Group",
        "description": "Group created via API test",
        "icon": "fa-users"
      }
    },
    "roles": {
      "name": "roles",
      "singular": "role",
      "api_prefix": "/api/crud6",
      "frontend_prefix": "/crud6",
      "test_id": 2,
      "safe_test_id_note": "Uses ID 2+ for safe testing",
      "api_validation_keys": ["id", "slug", "name"],
      "list_validation_keys": ["rows"],
      "enabled": true,
      "relationships": [
        {
          "name": "users",
          "type": "many_to_many",
          "nested_endpoint": true
        },
        {
          "name": "permissions",
          "type": "many_to_many",
          "nested_endpoint": true
        }
      ],
      "create_payload": {
        "slug": "api_test_role",
        "name": "API Test Role",
        "description": "Role created via API test"
      }
    },
    "permissions": {
      "name": "permissions",
      "singular": "permission",
      "api_prefix": "/api/crud6",
      "frontend_prefix": "/crud6",
      "test_id": 2,
      "safe_test_id_note": "Uses ID 2+ for safe testing",
      "api_validation_keys": ["id", "slug", "name"],
      "list_validation_keys": ["rows"],
      "enabled": true,
      "relationships": [
        {
          "name": "roles",
          "type": "many_to_many",
          "nested_endpoint": true
        },
        {
          "name": "users",
          "type": "many_to_many_through",
          "through": "roles",
          "nested_endpoint": true,
          "note": "Complex nested relationship through roles"
        }
      ],
      "create_payload": {
        "slug": "api_test_permission",
        "name": "API Test Permission",
        "description": "Permission created via API test"
      }
    },
    "activities": {
      "name": "activities",
      "singular": "activity",
      "api_prefix": "/api/crud6",
      "frontend_prefix": "/crud6",
      "test_id": 2,
      "safe_test_id_note": "Uses ID 2+ for safe testing",
      "api_validation_keys": ["id", "type"],
      "list_validation_keys": ["rows"],
      "enabled": true,
      "create_payload": {
        "user_id": 2,
        "type": "test_activity",
        "occurred_at": "2024-01-01 12:00:00",
        "description": "Activity created via API test"
      }
    }
  },
  "path_templates": {
    "authenticated": {
      "api": {
        "schema": {
          "method": "GET",
          "path": "{api_prefix}/{model}/schema",
          "description": "Get {model} schema definition",
          "expected_status": 200,
          "validation": {
            "type": "json",
            "contains": ["model", "fields"]
          }
        },
        "list": {
          "method": "GET",
          "path": "{api_prefix}/{model}",
          "description": "Get list of {model} via CRUD6 API",
          "expected_status": 200,
          "validation": {
            "type": "json",
            "contains": "{list_validation_keys}"
          }
        },
        "create": {
          "method": "POST",
          "path": "{api_prefix}/{model}",
          "description": "Create new {singular} via CRUD6 API",
          "expected_status": 200,
          "validation": {
            "type": "json",
            "contains": ["data", "id"]
          },
          "requires_permission": "create_{singular}",
          "note": "Requires payload with model-specific fields"
        },
        "single": {
          "method": "GET",
          "path": "{api_prefix}/{model}/{test_id}",
          "description": "Get single {singular} by ID via CRUD6 API",
          "expected_status": 200,
          "validation": {
            "type": "json",
            "contains": "{api_validation_keys}"
          }
        },
        "update": {
          "method": "PUT",
          "path": "{api_prefix}/{model}/{test_id}",
          "description": "Update {singular} via CRUD6 API",
          "expected_status": 200,
          "validation": {
            "type": "json"
          },
          "requires_permission": "update_{singular}_field",
          "note": "Requires payload with fields to update"
        },
        "update_field": {
          "method": "PUT",
          "path": "{api_prefix}/{model}/{test_id}/{field}",
          "description": "Update single field for {singular}",
          "expected_status": 200,
          "validation": {
            "type": "json"
          },
          "requires_permission": "update_{singular}_field",
          "note": "Field name and value depend on model schema"
        },
        "custom_action": {
          "method": "POST",
          "path": "{api_prefix}/{model}/{test_id}/a/{actionKey}",
          "description": "Execute custom action on {singular}",
          "expected_status": 200,
          "validation": {
            "type": "status_any",
            "acceptable_statuses": [200, 404, 500]
          },
          "note": "Action keys defined in model schema"
        },
        "relationship_attach": {
          "method": "POST",
          "path": "{api_prefix}/{model}/{test_id}/{relation}",
          "description": "Attach related items to {singular} (many-to-many)",
          "expected_status": 200,
          "validation": {
            "type": "status_any",
            "acceptable_statuses": [200, 403]
          },
          "note": "Relation names defined in model schema"
        },
        "relationship_detach": {
          "method": "DELETE",
          "path": "{api_prefix}/{model}/{test_id}/{relation}",
          "description": "Detach related items from {singular} (many-to-many)",
          "expected_status": 200,
          "validation": {
            "type": "status_any",
            "acceptable_statuses": [200, 403]
          },
          "note": "Relation names defined in model schema"
        },
        "nested_relationship": {
          "method": "GET",
          "path": "{api_prefix}/{model}/{test_id}/{relation}",
          "description": "Get related items for {singular} (nested endpoint)",
          "expected_status": 200,
          "validation": {
            "type": "json"
          },
          "note": "Relation names defined in model schema"
        },
        "delete": {
          "method": "DELETE",
          "path": "{api_prefix}/{model}/{test_id}",
          "description": "Delete {singular} via CRUD6 API",
          "expected_status": 200,
          "validation": {
            "type": "json"
          },
          "requires_permission": "delete_{singular}"
        }
      },
      "frontend": {
        "list": {
          "path": "{frontend_prefix}/{model}",
          "description": "{model} list page",
          "screenshot": true,
          "screenshot_name": "{model}_list"
        },
        "detail": {
          "path": "{frontend_prefix}/{model}/{test_id}",
          "description": "Single {singular} detail page",
          "screenshot": true,
          "screenshot_name": "{singular}_detail"
        }
      }
    },
    "unauthenticated": {
      "api": {
        "schema": {
          "method": "GET",
          "path": "{api_prefix}/{model}/schema",
          "description": "Attempt to access {model} schema without authentication",
          "expected_status": 401,
          "validation": {
            "type": "status_only"
          }
        },
        "list": {
          "method": "GET",
          "path": "{api_prefix}/{model}",
          "description": "Attempt to access {model} list without authentication",
          "expected_status": 401,
          "validation": {
            "type": "status_only"
          }
        },
        "create": {
          "method": "POST",
          "path": "{api_prefix}/{model}",
          "description": "Attempt to create {singular} without authentication",
          "expected_status": 401,
          "validation": {
            "type": "status_only"
          }
        },
        "single": {
          "method": "GET",
          "path": "{api_prefix}/{model}/{test_id}",
          "description": "Attempt to access single {singular} without authentication",
          "expected_status": 401,
          "validation": {
            "type": "status_only"
          }
        },
        "update": {
          "method": "PUT",
          "path": "{api_prefix}/{model}/{test_id}",
          "description": "Attempt to update {singular} without authentication",
          "expected_status": 401,
          "validation": {
            "type": "status_only"
          }
        },
        "delete": {
          "method": "DELETE",
          "path": "{api_prefix}/{model}/{test_id}",
          "description": "Attempt to delete {singular} without authentication",
          "expected_status": 401,
          "validation": {
            "type": "status_only"
          }
        }
      },
      "frontend": {
        "list": {
          "path": "{frontend_prefix}/{model}",
          "description": "Attempt to access {model} list page without authentication (should redirect to login)",
          "expected_status": 200,
          "validation": {
            "type": "redirect_to_login",
            "contains": ["/account/sign-in", "login"]
          }
        },
        "detail": {
          "path": "{frontend_prefix}/{model}/{test_id}",
          "description": "Attempt to access {singular} detail page without authentication (should redirect to login)",
          "expected_status": 200,
          "validation": {
            "type": "redirect_to_login",
            "contains": ["/account/sign-in", "login"]
          }
        }
      }
    }
  },
  "config": {
    "base_url": "http://localhost:8080",
    "auth": {
      "username": "admin",
      "password": "admin123"
    },
    "timeout": {
      "api": 10,
      "frontend": 30
    },
    "security": {
      "csrf": {
        "enabled": true,
        "note": "CSRF protection is enforced by UserFrosting 6's CsrfGuardMiddleware. For PHPUnit tests, CSRF is automatically handled by the testing framework. For manual testing, include X-CSRF-Token header.",
        "testing": {
          "phpunit": "Automatically handled by createJsonRequest() method",
          "manual": "Include X-CSRF-Token header with valid token"
        },
        "applies_to": ["POST", "PUT", "DELETE"]
      },
      "authentication": {
        "enabled": true,
        "note": "All endpoints require authentication via AuthGuard middleware",
        "applies_to": "all_endpoints"
      },
      "permissions": {
        "enabled": true,
        "note": "Operations require specific permissions as documented in model definitions"
      }
    }
  }
}
